	! SUBROUTINE FÜR DIE BERÜCKSICHTIGUNG VON HOHLKÖRPER
	
	SUBROUTINE SUB_FAK_HK(KLAYER,N_LAYER,H_ELEMENT,R_ROHR,F_ROHR)
	
	IMPLICIT NONE

      ! VARIABLENDEKLARATION
	
	INTEGER*4, INTENT(IN)	:: KLAYER
	DOUBLE PRECISION, INTENT(IN) :: N_LAYER,H_ELEMENT,R_ROHR
	DOUBLE PRECISION, INTENT(OUT):: F_ROHR
	
	DOUBLE PRECISION :: DH_,B_,L_,B_INF,B_SUP,B_M
	
	DH_ = H_ELEMENT/N_LAYER
	B_=DH_*(DBLE(KLAYER)-0.5D0)
      
      B_M=H_ELEMENT/2.0D0
      B_INF=H_ELEMENT/2.0D0-R_ROHR
      B_SUP=H_ELEMENT/2.0D0+R_ROHR
	
	IF ((B_.GT.B_INF).AND.(B_.LE.B_M)) THEN
		L_=SQRT(R_ROHR**2.0D0-(H_ELEMENT/2.0D0-B_)**2.0D0)
		F_ROHR=1.0D0-L_/R_ROHR
	ELSEIF ((B_.GT.B_M).AND.(B_.LT.B_SUP)) THEN
		L_=SQRT(R_ROHR**2.0D0-(B_-H_ELEMENT/2.0D0)**2.0D0)
		F_ROHR=1.0D0-L_/R_ROHR
      ELSE
		F_ROHR=1.0D0
	END IF
	END SUBROUTINE SUB_FAK_HK