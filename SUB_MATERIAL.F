!-----------------------------------------------------------------------
!     SUBROUTINE ZUM NEUAUFBAU DER MATERIALMATRIX.
!
!     PROGRAMMIERUNG:     DR. KAREL THOMA, HOCHSCHULE LUZERN
!                         PATRICK ROOS, HOCHSCHULE LUZERN
!     DATUM:              02.06.2014
!-----------------------------------------------------------------------
      SUBROUTINE SUB_MATERIAL(MATERIAL_ORG,SCHICHTINFO,IREF,ZSI,
     &                        KLAYER,IELEMENT,MATERIAL)


      IMPLICIT NONE

      ! VARIABLENDEKLARATION
      DOUBLE PRECISION, DIMENSION(76), INTENT(IN) :: MATERIAL_ORG
      INTEGER, INTENT(IN) :: SCHICHTINFO, IELEMENT, KLAYER
      DOUBLE PRECISION,DIMENSION(4),INTENT(IN)    :: ZSI
      INTEGER, DIMENSION(4),INTENT(IN)            :: IREF
      DOUBLE PRECISION, DIMENSION(60), INTENT(OUT) :: MATERIAL

      ! �BERGABE DER MATERIALKENNWERTE

      ! ALLGEMEIN:
      MATERIAL(1) = MATERIAL_ORG(1)
      MATERIAL(2) = MATERIAL_ORG(2)
      ! GEOMETRIE:
      MATERIAL(3) = MATERIAL_ORG(3)
      MATERIAL(4) = MATERIAL_ORG(4)
      MATERIAL(5) = MATERIAL_ORG(5)
      MATERIAL(6) = MATERIAL_ORG(6)
      ! BETON:
      MATERIAL(33) = MATERIAL_ORG(59)
      MATERIAL(34) = MATERIAL_ORG(60)
      MATERIAL(35) = MATERIAL_ORG(61)
      MATERIAL(36) = MATERIAL_ORG(62)
      MATERIAL(37) = MATERIAL_ORG(63)
      MATERIAL(38) = MATERIAL_ORG(64)
      MATERIAL(39) = MATERIAL_ORG(65)
      MATERIAL(40) = MATERIAL_ORG(66)
      MATERIAL(41) = MATERIAL_ORG(71)
      ! RISSABSTAND:
      MATERIAL(42) = MATERIAL_ORG(67)
      MATERIAL(43) = MATERIAL_ORG(68)
      MATERIAL(44) = MATERIAL_ORG(69)
      MATERIAL(45) = MATERIAL_ORG(70)

      IF (SCHICHTINFO .EQ. 0) THEN

      ! BEWEHRUNG IN X-RICHTUNG:
      MATERIAL(7) = MATERIAL_ORG(7)
      MATERIAL(8) = MATERIAL_ORG(8)
      MATERIAL(9) = 0D0
      MATERIAL(10) = 0D0
      MATERIAL(11) = 0D0
      MATERIAL(12) = 0D0
      MATERIAL(13) = 0D0
      MATERIAL(14) = 0D0
      MATERIAL(15) = 0D0
      MATERIAL(16) = 0D0
      MATERIAL(17) = 0D0
      MATERIAL(18) = 0D0
      MATERIAL(19) = 0D0
      ! BEWEHRUNG IN Y-RICHTUNG:
      MATERIAL(20) = MATERIAL_ORG(20)
      MATERIAL(21) = MATERIAL_ORG(21)
      MATERIAL(22) = 0D0
      MATERIAL(23) = 0D0
      MATERIAL(24) = 0D0
      MATERIAL(25) = 0D0
      MATERIAL(26) = 0D0
      MATERIAL(27) = 0D0
      MATERIAL(28) = 0D0
      MATERIAL(29) = 0D0
      MATERIAL(30) = 0D0
      MATERIAL(31) = 0D0
      MATERIAL(32) = 0D0

      ELSE IF (SCHICHTINFO .EQ. 1 .OR. SCHICHTINFO .EQ. 2) THEN

      ! BEWEHRUNG IN X-RICHTUNG:
      MATERIAL(7) = MATERIAL_ORG(46)
      MATERIAL(8) = MATERIAL_ORG(47)
      MATERIAL(9) = MATERIAL_ORG(48)
      MATERIAL(10) = MATERIAL_ORG(49)
      MATERIAL(11) = MATERIAL_ORG(50)
      MATERIAL(12) = MATERIAL_ORG(51)
      MATERIAL(13) = MATERIAL_ORG(52)
      MATERIAL(14) = MATERIAL_ORG(53)
      MATERIAL(15) = MATERIAL_ORG(54)
      MATERIAL(16) = MATERIAL_ORG(55)
      MATERIAL(17) = MATERIAL_ORG(56)
      MATERIAL(18) = MATERIAL_ORG(57)
      MATERIAL(19) = MATERIAL_ORG(58)
      ! BEWEHRUNG IN Y-RICHTUNG:
      MATERIAL(20) = MATERIAL_ORG(33)
      MATERIAL(21) = MATERIAL_ORG(34)
      MATERIAL(22) = MATERIAL_ORG(35)
      MATERIAL(23) = MATERIAL_ORG(36)
      MATERIAL(24) = MATERIAL_ORG(37)
      MATERIAL(25) = MATERIAL_ORG(38)
      MATERIAL(26) = MATERIAL_ORG(39)
      MATERIAL(27) = MATERIAL_ORG(40)
      MATERIAL(28) = MATERIAL_ORG(41)
      MATERIAL(29) = MATERIAL_ORG(42)
      MATERIAL(30) = MATERIAL_ORG(43)
      MATERIAL(31) = MATERIAL_ORG(44)
      MATERIAL(32) = MATERIAL_ORG(45)

      ELSE IF (SCHICHTINFO .EQ. 3 .OR. SCHICHTINFO .EQ. 4) THEN

      ! BEWEHRUNG IN X-RICHTUNG:
      MATERIAL(7) = MATERIAL_ORG(7)
      MATERIAL(8) = MATERIAL_ORG(8)
      MATERIAL(9) = MATERIAL_ORG(9)
      MATERIAL(10) = MATERIAL_ORG(10)
      MATERIAL(11) = MATERIAL_ORG(11)
      MATERIAL(12) = MATERIAL_ORG(12)
      MATERIAL(13) = MATERIAL_ORG(13)
      MATERIAL(14) = MATERIAL_ORG(14)
      MATERIAL(15) = MATERIAL_ORG(15)
      MATERIAL(16) = MATERIAL_ORG(16)
      MATERIAL(17) = MATERIAL_ORG(17)
      MATERIAL(18) = MATERIAL_ORG(18)
      MATERIAL(19) = MATERIAL_ORG(19)
      ! BEWEHRUNG IN Y-RICHTUNG:
      MATERIAL(20) = MATERIAL_ORG(20)
      MATERIAL(21) = MATERIAL_ORG(21)
      MATERIAL(22) = MATERIAL_ORG(22)
      MATERIAL(23) = MATERIAL_ORG(23)
      MATERIAL(24) = MATERIAL_ORG(24)
      MATERIAL(25) = MATERIAL_ORG(25)
      MATERIAL(26) = MATERIAL_ORG(26)
      MATERIAL(27) = MATERIAL_ORG(27)
      MATERIAL(28) = MATERIAL_ORG(28)
      MATERIAL(29) = MATERIAL_ORG(29)
      MATERIAL(30) = MATERIAL_ORG(30)
      MATERIAL(31) = MATERIAL_ORG(31)
      MATERIAL(32) = MATERIAL_ORG(32)

      ELSE IF (SCHICHTINFO .EQ. 5 .OR. SCHICHTINFO .EQ. 6) THEN

      ! BEWEHRUNG IN X-RICHTUNG:
      MATERIAL(7) = MATERIAL_ORG(7)
      MATERIAL(8) = MATERIAL_ORG(8)
      MATERIAL(9) = MATERIAL_ORG(9)+MATERIAL_ORG(48)
      MATERIAL(10) = MATERIAL_ORG(10)
      MATERIAL(11) = MATERIAL_ORG(11)
      MATERIAL(12) = MATERIAL_ORG(12)
      MATERIAL(13) = MATERIAL_ORG(13)
      MATERIAL(14) = MATERIAL_ORG(14)
      MATERIAL(15) = MATERIAL_ORG(15)
      MATERIAL(16) = MATERIAL_ORG(16)
      MATERIAL(17) = MATERIAL_ORG(17)
      MATERIAL(18) = MATERIAL_ORG(18)
      MATERIAL(19) = MATERIAL_ORG(19)
      ! BEWEHRUNG IN Y-RICHTUNG:
      MATERIAL(20) = MATERIAL_ORG(20)
      MATERIAL(21) = MATERIAL_ORG(21)
      MATERIAL(22) = MATERIAL_ORG(22)+MATERIAL_ORG(35)
      MATERIAL(23) = MATERIAL_ORG(23)
      MATERIAL(24) = MATERIAL_ORG(24)
      MATERIAL(25) = MATERIAL_ORG(25)
      MATERIAL(26) = MATERIAL_ORG(26)
      MATERIAL(27) = MATERIAL_ORG(27)
      MATERIAL(28) = MATERIAL_ORG(28)
      MATERIAL(29) = MATERIAL_ORG(29)
      MATERIAL(30) = MATERIAL_ORG(30)
      MATERIAL(31) = MATERIAL_ORG(31)
      MATERIAL(32) = MATERIAL_ORG(32)

      END IF

      ! IREF NR. LAYER MIT BEWEHRUNG
      MATERIAL(46)= REAL(IREF(1))
      MATERIAL(47)= REAL(IREF(2))
      MATERIAL(48)= REAL(IREF(3))
      MATERIAL(49)= REAL(IREF(4))
      ! STATISCHE HEBELARME IN BEWEHRUNGSSCHWERPUNTK
      MATERIAL(50)=ZSI(1)
      MATERIAL(51)=ZSI(2)
      MATERIAL(52)=ZSI(3)
      MATERIAL(53) =ZSI(4)
      ! L�NGE DES VEKTORS F�R DIE QUERKRAFT AUS SMICS SHELL 181
      MATERIAL(54) =(8*(MATERIAL_ORG(3)-1)+58)
      ! DRUCKDIAGONALENNEIGUNG KERN (SANDWICHMODELL)
      MATERIAL(55)= MATERIAL_ORG(72)
      ! BRUCHKRITERIUM QUERKRAFT KERN
      MATERIAL(56) = MATERIAL_ORG(73)
      ! FAKTOR BRUCHKRITERIUM QUERKRAFT IN KERN
      MATERIAL(57) = MATERIAL_ORG(74)
      ! FLIESSGRENZE B�GEL
      MATERIAL(58) = MATERIAL_ORG(75)
      ! ELEMENTNUMMER F�R QUERKRAFT
      MATERIAL(59) = REAL(IELEMENT)
      ! LAYERNUMMER F�R QUERKRAFT
      MATERIAL(60) = KLAYER

      END SUBROUTINE SUB_MATERIAL