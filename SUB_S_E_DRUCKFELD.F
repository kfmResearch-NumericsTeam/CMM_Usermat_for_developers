!-----------------------------------------------------------------------
!     SUBROUTINE ZUR BESTIMMUNG DES GEWï¿½HLTEN DRUCKFELDMODELLS ZUR
!     BERECHNUNG DER SPANNUNGEN ANHAND DER VERZERRUNGEN
!
!     PROGRAMMIERUNG:     DR. KAREL THOMA, HOCHSCHULE LUZERN
!                         PATRICK ROOS, HOCHSCHULE LUZERN
!     DATUM:              02.06.2014
!-----------------------------------------------------------------------
      SUBROUTINE SUB_S_E_DRUCKFELD(EX,EY,GAMMA_XY,DEPS,MATERIAL,
     &                             SCHICHTINFO,SPANNUNGEN,DRUCKFELD,
     &                             STATE_DF)

      IMPLICIT NONE

      ! VARIABLENDEKLARATION
      DOUBLE COMPLEX, INTENT(IN) :: EX, EY, GAMMA_XY
      DOUBLE PRECISION, DIMENSION(60), INTENT(IN) :: MATERIAL
      DOUBLE PRECISION, DIMENSION(3), INTENT(IN) :: DEPS
      INTEGER, INTENT(IN) :: SCHICHTINFO
      DOUBLE COMPLEX, DIMENSION(3), INTENT(OUT) :: SPANNUNGEN
      DOUBLE PRECISION, DIMENSION(12), INTENT(OUT) :: DRUCKFELD
      INTEGER, DIMENSION(2), INTENT(OUT) :: STATE_DF

      INTEGER :: MODELL

      ! INTERFACES ZU EXTERNEN SUBROUTINEN
      INTERFACE

      SUBROUTINE SUB_S_E_CMM(EX,EY,GAMMA_XY,DEPS,MATERIAL,SCHICHTINFO,
     &                       SPANNUNGEN,DRUCKFELD,STATE_DF)
        DOUBLE COMPLEX, INTENT(IN) :: EX, EY, GAMMA_XY
        DOUBLE PRECISION, DIMENSION(60), INTENT(IN) :: MATERIAL
        DOUBLE PRECISION, DIMENSION(3), INTENT(IN) :: DEPS
        INTEGER, INTENT(IN) :: SCHICHTINFO
        DOUBLE COMPLEX, DIMENSION(3), INTENT(OUT):: SPANNUNGEN
        DOUBLE PRECISION, DIMENSION(12), INTENT(OUT) :: DRUCKFELD
        INTEGER, DIMENSION(2), INTENT(OUT) :: STATE_DF
      END SUBROUTINE SUB_S_E_CMM

      END INTERFACE

      MODELL = MATERIAL(2)

      ! UNTERSCHEIDUNG DRUCKFELDMODELL

      IF (ABS(MODELL-1.0D0) .LT. 0.1D0) THEN

        CALL SUB_S_E_CMM(EX,EY,GAMMA_XY,DEPS,MATERIAL,SCHICHTINFO,
     &                   SPANNUNGEN,DRUCKFELD,STATE_DF)

      !ELSEIF (ABS(MODELL-1.0D0) .LT. 1.1D0) THEN

        !CALL SUB_S_E_OCF(EX,EY,GAMMA_XY,MATERIAL,SPANNUNGEN,DRUCKFELD,STATE_DF)

      !ELSEIF (ABS(MODELL-1.0D0) .LT. 2.1D0) THEN

        !CALL SUB_S_E_MCFT(EX,EY,GAMMA_XY,MATERIAL,SPANNUNGEN,DRUCKFELD,STATE_DF)

      !END IF

      END IF

      END SUBROUTINE SUB_S_E_DRUCKFELD