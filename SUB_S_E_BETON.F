!-----------------------------------------------------------------------
!     SUBROUTINE ZUR BERECHNUNG DER BETONHAUPTDRUCKSPANNUNG IN FUNKTION
!     DER HAUPTVERZERRUNGEN Fï¿½R EIN BELIEBIGES WERKSTOFFGESETZ
!     (SARGIN, KAUFMANN....)
!
!     PROGRAMMIERUNG:     DR. KAREL THOMA, HOCHSCHULE LUZERN
!                         PATRICK ROOS, HOCHSCHULE LUZERN
!     DATUM:              02.06.2014
!-----------------------------------------------------------------------
      SUBROUTINE SUB_S_E_BETON(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)

      IMPLICIT NONE

      ! VARIABLENDEKLARATION
      INTEGER, DIMENSION(2), INTENT(IN) :: BETON
      DOUBLE COMPLEX, INTENT(IN) :: E1, E3, FCC, ECU, K_E
      DOUBLE COMPLEX, INTENT(OUT):: SIGMA_C3

      ! INTERFACES ZU EXTERNEN SUBROUTINEN
      INTERFACE
        SUBROUTINE SUB_S_E_CS_SARGIN(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)
        INTEGER, DIMENSION(2), INTENT(IN) :: BETON
        DOUBLE COMPLEX, INTENT(IN) :: E1,E3,FCC,ECU,K_E
        DOUBLE COMPLEX, INTENT(OUT) :: SIGMA_C3
        END SUBROUTINE SUB_S_E_CS_SARGIN

        SUBROUTINE SUB_S_E_CS_KAUFMANN(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)
        INTEGER, DIMENSION(2), INTENT(IN) :: BETON
        DOUBLE COMPLEX, INTENT(IN) :: E1,E3,FCC,ECU,K_E
        DOUBLE COMPLEX, INTENT(OUT) :: SIGMA_C3
        END SUBROUTINE SUB_S_E_CS_KAUFMANN

        SUBROUTINE SUB_S_E_CC_SARGIN(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)
        INTEGER, DIMENSION(2), INTENT(IN) :: BETON
        DOUBLE COMPLEX, INTENT(IN) :: E1,E3,FCC,ECU,K_E
        DOUBLE COMPLEX, INTENT(OUT) :: SIGMA_C3
        END SUBROUTINE SUB_S_E_CC_SARGIN
      END INTERFACE

      ! UNTERSCHEIDUNG WERKSTOFFGESETZE

      IF (ABS(BETON(1)-1.0D0) .LT. 0.1D0) THEN

      CALL SUB_S_E_CS_SARGIN(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)

      ELSEIF (ABS(BETON(1)-1.0D0) .LT. 1.1D0) THEN

      CALL SUB_S_E_CS_KAUFMANN(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)

      ELSEIF (ABS(BETON(1)-1.0D0) .LT. 2.1D0) THEN

      CALL SUB_S_E_CC_SARGIN(BETON,E1,E3,FCC,ECU,K_E,SIGMA_C3)

      END IF

      ! KANN BELIEBIG ERWEITERT WERDEN, Z.B.:

      ! ELSEIF (ABS(BETON(1)-1.0D0) .LT. 3.1D0) THEN

      ! CALL SUB_S_E_CH_SARGIN(E1,E3,FCC,ECU,K_E,SIGMA_C3)

      ! END IF

      END SUBROUTINE SUB_S_E_BETON